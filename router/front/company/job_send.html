<!--顶部导航栏-->
<div class="container-fluid fixed-top bor-b-sol bor-eee align-middle">
  <div class="row h-45 lh-45 bg-white">
    <div class="col-2 ">
      <a href="javascript:history.go(-1)" class='t-c-0a0'>
        <i class="icon text-center f-s-15">&#xe86c;</i>
      </a>
    </div>
    <div class="col-8 text-center">
      <span>发布的岗位</span>
    </div>
    <div class="col-2"></div>
  </div>
</div>
<!--简历列表-->
<div>
  <ul class="m-t-55 m-b-80 f-s-8">
    <li class="m-10 p-10 bg-white bor-r-5 pr row" v-for = "job in jobs">
      <p class="w-100 m-b-10">
        <span class="f-s-10 f-w-6">{{job.name}}</span>
        <span class="float-right">{{time.dateFormat('yyyy/MM/dd', job.issue_time)}}</span>
      </p>
      <p class="w-100 m-b-5">
        <span class="t-c-ff5">{{job.pay}}</span>
      </p>
      <p class="w-100 m-b-5">
        <span><i class="icon">&#xe621;</i>{{job.address}}</span>
        <span><i class="icon">&#xe86a;</i>{{job.education}}</span>
        <span><i class="icon">&#xe68c;</i>{{job.experience}}</span>
      </p>
      <p class="w-100 m-b-5">
        <span class=" bor-sol bor-82b bor-r-5 f-s-5 m-l-5 br-5 p-x-5" v-for='n in job.benefit'>{{n}}</span>
      </p>
      <p class="w-100 m-b-5">
        <i class="icon">&#xe621;</i>
        <span>{{job.address}}</span>
      </p>
      <p class="text-center p-0 w-100 m-b-5">
        <button type="button" class="btn btn-secondary p-y-3 p-x-15 f-s-8 m-l-p3" @click = 'lose(job.id)'>删除</button>
        <a :href="'/front/company/station_edit?id=' + job.id" name="" id="" class="btn btn-secondary p-y-3 p-x-15 f-s-8 m-l-p3" role="button">编辑</a>
        <button type="button" class="btn btn-primary p-y-3 p-x-15 f-s-8 m-l-p3" @click = 'update(job.id)'>刷新</button>
      </p>
    </li>
  </ul>
</div>
<%- f%>

<script> 
new Vue({
  el: '#app',
  data: {
    jobs:[],
  },
  mounted () {
    this.ajax.get('/company/job/list', (res) => {
      this.jobs = res.data
      for(let job of this.jobs){
        job.benefit = job.benefit.split("|")
      }
    }, (err) => {
      console.log(err)
    })
  },
  methods: {
    loadAfter(){
    
    },
    lose(id){
      this.ajax.put('/delete/job', {id:id}, (res) => {
        weui.toast('删除成功',1000);
        setTimeout("window.location.reload()",2000)
      }, (err) => {
        console.log(err)
      })
    },
    update(id){
      this.ajax.put('/update/resumetime', {id:id}, (res) => {
        weui.toast('更新成功', 500);
        setTimeout("window.location.reload()",2000)
      }, (err) => {
        console.log(err)
      })
    }
  }
})
</script>